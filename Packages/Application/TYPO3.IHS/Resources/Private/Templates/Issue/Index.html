<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en"
      xmlns:f="http://xsd.helmut-hummel.de/ns/TYPO3/Fluid/ViewHelpers">

<f:layout name="Default" />

<f:section name="Title">A list of issues</f:section>

<f:section name="Content">
	<p><f:link.action class="btn btn-primary" action="new">Create a new issue</f:link.action></p>
	<div class="issue-visualsearch visualsearch" searchUrl="{f:uri.action(action:'index', controller:'Issue', package:'TYPO3.IHS')}"></div>

	<div class="row-fluid issues">
		<div class="span3 saved-searches-container">
			<div class="well">
				<h3>Favorites</h3>
				<ul class="saved-searches unstyled">
				</ul>
			</div>
		</div>
		<div class="span9 list-of-issues">
			<div class="loading-overlay">
			<span>
				<img src="{f:uri.resource(path: 'layouts/img/ajax-loader.gif')}" />
			</span>
			</div>
			<div class="issues">
				<!-- WORKAROUND: Counting issues does not work here, because of an advanced HAVING and GROUP BY clause which makes the COUNT query fail.
				     This is a FLOW BUG: Query::count() does not work with these kinds of advanced queries and may need to be refactored/rewritten
				-->
				<f:if condition="{issues.first}">
					<f:then>
						<f:render partial="Issue/ListOfIssues" section="Content" arguments="{issues: issues}"/>
					</f:then>
					<f:else>
						<p>No issues created yet.</p>
					</f:else>
				</f:if>
			</div>
		</div>
	</div>

</f:section>
</html>