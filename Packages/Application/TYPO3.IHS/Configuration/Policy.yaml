#                                                                        #
# Security policy for the TYPO3 IHS package                             #
#                                                                        #

privilegeTargets:
  Neos\Flow\Security\Authorization\Privilege\Method\MethodPrivilege:
    'TYPO3.IHS:AllControllerActions':
      matcher: 'within(Neos\Flow\Mvc\Controller\AbstractController) && method(public .*->(?!initialize).*Action())'
    'TYPO3.IHS:WidgetControllers':
      matcher: 'method(Neos\FluidAdaptor\ViewHelpers\Widget\Controller\AutocompleteController->(index|autocomplete)Action()) || method(Neos\FluidAdaptor\ViewHelpers\Widget\Controller\PaginateController->indexAction()) || method(Neos\ContentRepository\ViewHelpers\Widget\Controller\PaginateController->indexAction())'
    'TYPO3.IHS:Login':
      matcher: 'method(TYPO3\IHS\Controller\LoginController->(index|authenticate)Action()) || method(Neos\Flow\Security\Authentication\Controller\AbstractAuthenticationController->authenticateAction())'
    'TYPO3.IHS:Advisories':
      matcher: 'method(TYPO3\IHS\Controller\AdvisoryController->(index|show|rssFeed)Action()) || method(TYPO3\IHS\Controller\ProductController->(getProductTypesAsJSON|getProductsAsJSON)Action()) || method(TYPO3\IHS\Controller\IssueController->(getVulnerabilityTypesAsJSON)Action())'
roles:
  'Neos.Flow:Anonymous':
    privileges:
      -
        privilegeTarget: 'TYPO3.IHS:WidgetControllers'
        permission: GRANT
      -
        privilegeTarget: 'TYPO3.IHS:Login'
        permission: GRANT
      -
        privilegeTarget: 'TYPO3.IHS:Advisories'
        permission: GRANT
  'TYPO3.IHS:Editor':
    parentRoles:
      - 'TYPO3.IHS:'
  'TYPO3.IHS:Administrator':
    parentRoles:
      - 'TYPO3.IHS:Editor'
      - 'Neos.Neos:Administrator'
    privileges:
      -
        privilegeTarget: 'TYPO3.IHS:AllControllerActions'
        permission: GRANT
